package com.userSrvc.client;

import static org.junit.Assert.assertTrue;

import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.test.context.junit4.SpringRunner;
import org.springframework.web.client.HttpStatusCodeException;

import com.userSrvc.client.entities.UUser;
import com.userSrvc.client.error.ERROR_MSGS;
import com.userSrvc.client.error.RestResponseException;
import com.userSrvc.client.services.UserSrvcExt;
import com.userSrvc.client.services.impl.UserSrvcExtImpl;
import com.userSrvc.client.util.Util;

@RunWith(SpringRunner.class)
@SpringBootTest(classes = UserSrvcExtImpl.class)
public class NewTest
{
	@Autowired
	private UserSrvcExt userSrvcExt;

	String emailValid = Util.randomString(50, "[a-zA-Z0-9@\\.]", "[a-zA-Z0-9]{1,}@[a-zA-Z0-9]{1,}\\.[a-zA-Z0-9]{1,}");
	String emailInvalid = "badFormat@email,com";
	String passwordValid = "garbally gook";
	String passwordInvalid = "garbally gook2";
	String nameOriginal = "Murray Rothbard";
	String nameUpdated = "Freidric Engles";
	UUser user = new UUser(0, nameOriginal, emailValid, passwordValid);
	
	@Test
    public void testApp()
    {
    	add();
    	login();
    }
    
    public void add() {
    	// Add valid credentails
    	try {
			userSrvcExt.add(user);
			assertTrue(true);
		} catch (RestResponseException e) {
			System.out.println(e.getResponseBodyAsString());
			assertTrue(false);
		}
    	
    	// Add valid credentails with existing email
    	try {
    		userSrvcExt.add(user);
    		assertTrue(false);
    	} catch (HttpStatusCodeException e) {
    		assertTrue(Util.responseExceptContains(e, 
    				ERROR_MSGS.EMAIL_ALREADY_REGISTERED));
    	}

    	// Try to add credentails with invalid email;
    	user.setEmail(emailInvalid);
    	try {
    		userSrvcExt.add(user);
    		assertTrue(false);
    	} catch (HttpStatusCodeException e) {
    		assertTrue(Util.responseExceptContains(e, 
    				ERROR_MSGS.EMAIL_INVALID_FORMAT));
    	}
    	
    	user.setEmail(emailValid);
    }
    
    public void login() {
    	
    }
    
    public void authinticate() {
    	
    }
    
    public void update() {
    	
    }
    
    public void get() {
    	
    }
    
    public void updatePass() {
    	
    }
}
